{% extends 'base.html' %}

    {% block head_scripts %}
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.3.4/leaflet.js"></script>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.3.4/leaflet.css" />

        <link rel="stylesheet" href="{{ url_for('app_bp.static', filename='css/GpPluginLeaflet.css') }}"/>
        <script src="{{ url_for('app_bp.static', filename='js/GpPluginLeaflet.js') }}"></script>

    {% endblock head_scripts %}


{% block content %}

    <section class="section">
        <div class="container is-fluid">
            <div class="columns">
                <div class="column">
                    <div id="viewerDiv" style="width:1000px; height:800px;"></div>
                </div>
            </div>
        </div>
    </section>

{% endblock content %}


{% block scripts %}
<script type="text/javascript">
    function go() {
        const map = L.map("viewerDiv").setView([48.845, 2.424], 5);
        const lyrOSM= L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png?') ;
        const lyrOrtho = L.geoportalLayer.WMTS({
            layer: "ORTHOIMAGERY.ORTHOPHOTOS",
        });
        const lyrMaps = L.geoportalLayer.WMTS({
            layer: "GEOGRAPHICALGRIDSYSTEMS.MAPS",
        }, { // leafletParams
            opacity: 0.7
        });

        map.addLayer(lyrOrtho);
        map.addLayer(lyrOSM) ;
        map.addLayer(lyrMaps) ;
        const layerSwitcher = L.geoportalControl.LayerSwitcher({
            layers : [{
                layer : lyrOSM,
                config : {
                    title : "OSM",
                    description : "Couche Open Street Maps"
                }
            }]
        });
        map.addControl(layerSwitcher);

    }

    Gp.Services.getConfig({
        apiKey : "jhyvi0fgmnuxvfv0zjzorvdn",
        onSuccess : go
    }) ;

    const infoDiv= document.getElementById("info") ;
    infoDiv.innerHTML= "<p> Extension Leaflet version "+Gp.leafletExtVersion+" ("+Gp.leafletExtDate+")</p>" ;
</script>
{% endblock scripts %}